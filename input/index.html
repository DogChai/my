<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .guize ol {
            margin-top: 5px;
        }
        
        label {
            font-size: 22px;
            text-align: left;
            width: 500px;
            position: relative;
            margin-bottom: 30px;
            display: block;
            line-height: 46px;
            text-align: right;
        }
        
        label .name {
            margin-right: 10px;
        }
        
        label input {
            width: 350px;
            height: 40px;
            float: right;
            border-radius: 5px;
            border: 2px solid black;
            font-size: 18px;
            text-indent: 1em;
            outline: none;
        }
        
        label .test {
            position: absolute;
            right: 0;
            top: 60px;
            line-height: 0;
            font-size: 18px;
            font-family: '仿宋';
            font-weight: bold;
        }
        
        button {
            width: 80px;
            height: 45px;
            background: lightblue;
            border: none;
            border-radius: 5px;
            margin-left: 420px;
            cursor: pointer;
            outline: none;
            transition: all .5s;
        }
        
        button:hover {
            background: skyblue;
        }
    </style>
</head>

<body>
    <div class="guize">
        校验规则
        <ol>
            <li>表单获得焦点时，下方显示表单填写规则</li>
            <li>校验结果正确时，表单边框显示绿色，并在下方显示验证通过的描述文字</li>
            <li>校验结果错误时，表单边框显示红色，并在下方显示验证错误的描述文字</li>
            <li>点击提交按钮时，对页面中所有输入进行校验，校验结果显示方式同上。</li>
            <li>若所有表单校验通过，弹窗显示“提交成功”，否则显示“提交失败”</li>
        </ol>
    </div>
    <label for=""><span class="name">名称</span>
        <input type="text" name="" value="">
        <span class="test"></span>
    </label>
    <br>
    <label for=""><span class="name">密码</span> 
        <input type="text" name="" value="">
        <span class="test"></span>
    </label>
    <br>
    <label for=""><span class="name">密码确认</span> 
        <input type="text" name="" value="">
        <span class="test"></span>
    </label>
    <br>
    <label for=""><span class="name">邮箱</span> 
        <input type="text" name="" value="">
        <span class="test"></span>
    </label>
    <br>
    <label for=""><span class="name">手机</span> 
        <input type="text" name="" value="">
        <span class="test"></span>
    </label>
    <button type="">提交</button>

    <script>
        var data = [
            {
                "color": [
                    "gray",
                    "red",
                    "green"
                ],
                "text": {
                    "name": [
                        '必填，长度为4~16个字符',
                        '名称长度错误',
                        '名称可用'
                    ],
                    "pass": [
                        '必填，长度为4~16个字符',
                        '名称长度错误',
                        '名称可用'
                    ],
                    "reppass": [
                        '再次输入相同的密码',
                        '输入相同的密码',
                        '密码一致'
                    ],
                    "email": [
                        '输入邮箱',
                        '请输入正确的邮箱',
                        '邮箱正确'
                    ],
                    "mobile": [
                        '输入手机号',
                        '请输入正确的手机号',
                        '手机格式正确'
                    ],
                }
            }

        ]

        var label = document.getElementsByTagName('label');
        var test = document.getElementsByClassName('test');

        //e 传入元素
        //n 所属类别 
        //i 索引值
        //num 
        function testFirst(e, n, i, num) {
            e.style.borderColor = data[0].color[num];
            test[i].innerHTML = data[0].text[n][num];
            test[i].style.color = data[0].color[num];
        }

        //inex 索引值
        //val 当前的值
        //ele 当前元素
        //n 所属类别
        var password = null;
        var reg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/; 
        function testsecond(index, val, ele, n) {
            // var password = null;
            if (index == 0) {
                if (val == '') {
                    testFirst(ele, n, index, 1);
                } else {
                    if (val.length < 4) {
                        testFirst(ele, n, index, 1);
                    }
                    if (val.length > 16) {
                        testFirst(ele, n, index, 1);
                    }

                    else {
                        testFirst(ele, n, index, 2);
                    }
                }
            }
            else if (index == 1) {
                if (val == '') {
                    testFirst(ele, n, index, 1);
                } else {
                    password = val;
                    if (val.length < 4) {
                        testFirst(ele, n, index, 1);
                    }
                    if (val.length > 16) {
                        testFirst(ele, n, index, 1);
                    }

                    else {
                        testFirst(ele, n, index, 2);
                    }
                }
            }
            else if (index == 2) {
                console.log(password);
                if(val != password) {
                    testFirst(ele, n, index, 1);
                }else {
                    testFirst(ele, n, index, 2);
                }
            }
            else if (index == 3) {
                if(reg.test(val)) {
                    testFirst(ele, n, index, 2);
                }else {
                    testFirst(ele, n, index, 1);
                }
            }
            else if (index == 4) {
                if (val == '') {
                    testFirst(ele, n, index, 1);
                } else {
                    if(val.length == 11) {
                        testFirst(ele, n, index, 2);
                    }else {
                        testFirst(ele, n, index, 1);
                    }
                }
            }
        }


        for (let i = 0; i < label.length; i++) {

            //得到焦点 提示输入内容
            label[i].getElementsByTagName('input')[0].onfocus = function () {
                if (i == 0) {
                    var index = i;
                    var ele = this;
                    var n = "name";
                    testFirst(ele, n, index, 0);
                }
                else if (i == 1) {
                    var index = i;
                    var ele = this;
                    var n = "pass";
                    testFirst(ele, n, index, 0);
                }
                else if (i == 2) {
                    var index = i;
                    var ele = this;
                    var n = "reppass";
                    testFirst(ele, n, index, 0);
                }
                else if (i == 3) {
                    var index = i;
                    var ele = this;
                    var n = "email";
                    testFirst(ele, n, index, 0);
                }
                else if (i == 4) {
                    var index = i;
                    var ele = this;
                    var n = "mobile";
                    testFirst(ele, n, index, 0);
                }
            }

            //失去焦点 提示输入内容是否正确
            label[i].getElementsByTagName('input')[0].onblur = function () {
                if (i == 0) {
                    var val = this.value;
                    var ele = this;
                    //i 索引值
                    //val 当前的值
                    //ele 当前元素
                    //所属类别
                    testsecond(i, val, ele, 'name');
                }
                else if (i == 1) {
                    var val = this.value;
                    var ele = this;
                    testsecond(i, val, ele, 'pass');
                }
                else if (i == 2) {
                    var val = this.value;
                    var ele = this;
                    testsecond(i, val, ele, 'reppass');
                }
                else if (i == 3) {
                    var val = this.value;
                    var ele = this;
                    testsecond(i, val, ele, 'email');
                }
                else if (i == 4) {
                    var val = this.value;
                    var ele = this;
                    testsecond(i, val, ele, 'mobile');
                }
            }
        }
    </script>
</body>

</html>